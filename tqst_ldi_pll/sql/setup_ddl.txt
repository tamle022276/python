CREATE SET TABLE RETURN_REASON_LDI ,NO FALLBACK ,
NO BEFORE JOURNAL,
NO AFTER JOURNAL,
CHECKSUM = DEFAULT,
DEFAULT MERGEBLOCKRATIO,
WITH CONCURRENT ISOLATED LOADING FOR ALL
     (
      RETURN_REASON_CD VARCHAR(50) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'RETURN_REASON_CD' NOT NULL,
      RETURN_REASON_DESC VARCHAR(250) CHARACTER SET UNICODE NOT CASESPECIFIC TITLE 'RETURN_REASON_DESC')
UNIQUE PRIMARY INDEX RER_UPI ( RETURN_REASON_CD );

REPLACE VIEW RETURN_REASON_LDI_V AS LOCKING RETURN_REASON_LDI FOR LOAD COMMITTED SELECT * FROM RETURN_REASON_LDI;


/* PPL table should have primary index only for concurrency testing on different partitions. No secondary index, hash/join index */

CREATE MULTISET TABLE LOCATION_PLL ,FALLBACK ,
NO BEFORE JOURNAL,
NO AFTER JOURNAL,
CHECKSUM = DEFAULT,
DEFAULT MERGEBLOCKRATIO
     (
      LOCATION_ID INTEGER TITLE 'LOCATION_ID' NOT NULL,
      LOCATION_NAME CHAR(40) CHARACTER SET UNICODE NOT CASESPECIFIC TITLE 'LOCATION_NAME',
      LOCATION_OPEN_DT DATE FORMAT 'YYYY-MM-DD' TITLE 'LOCATION_OPEN_DT',
      LOCATION_CLOSE_DT DATE FORMAT 'YYYY-MM-DD' TITLE 'LOCATION_CLOSE_DT',
      LOCATION_EFFECTIVE_DT DATE FORMAT 'YYYY-MM-DD' TITLE 'LOCATION_EFFECTIVE_DT',
      LOCATION_TOTAL_AREA_MEAS DECIMAL(18,4) TITLE 'LOCATION_TOTAL_AREA_MEAS' NOT NULL,
      CHAIN_CD VARCHAR(50) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'CHAIN_CD',
      CHANNEL_CD VARCHAR(50) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'CHANNEL_CD',
      DISTRICT_CD VARCHAR(50) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'DISTRICT_CD',
      PARENT_LOCATION_ID INTEGER TITLE 'PARENT_LOCATION_ID',
      LOCATION_MGR_ASSOCIATE_ID INTEGER TITLE 'LOCATION_MGR_ASSOCIATE_ID',
      LOCATION_TYPE_CD VARCHAR(10) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'LOCATION_TYPE_CD',
      LOCATION_POINT SYSUDTLIB.ST_GEOMETRY(16776192) INLINE LENGTH 9920 TITLE 'LOCATION_POINT',
      LOCATION_LINE SYSUDTLIB.ST_GEOMETRY(16776192) INLINE LENGTH 9920 TITLE 'LOCATION_LINE' DEFAULT NULL ,
      LOCATION_GeomCollection SYSUDTLIB.ST_GEOMETRY(16776192) INLINE LENGTH 9920 TITLE 'LOCATION_GeomCollection',
      CUSTOMER_AREAS SYSUDTLIB.ST_GEOMETRY(16776192) INLINE LENGTH 9920 TITLE 'CUSTOMER_AREAS', 
CONSTRAINT LOC_SDRI_1 FOREIGN KEY ( LOCATION_TYPE_CD ) REFERENCES WITH NO CHECK OPTION LOCATION_TYPE ( LOCATION_TYPE_CD ),
CONSTRAINT LOC_SDRI_2 FOREIGN KEY ( CHANNEL_CD ) REFERENCES WITH NO CHECK OPTION CHANNEL ( CHANNEL_CD ),
CONSTRAINT LOC_SDRI_3 FOREIGN KEY ( DISTRICT_CD ) REFERENCES WITH NO CHECK OPTION DISTRICT ( DISTRICT_CD ))
PRIMARY INDEX LOC_ID ( LOCATION_ID )
PARTITION BY ( COLUMN ALL BUT (ROW(CHAIN_CD, CHANNEL_CD, DISTRICT_CD)) ADD 10,
RANGE_N(LOCATION_ID  BETWEEN 0  AND 2000000  EACH 100 ,
 NO RANGE OR UNKNOWN),RANGE_N(LOCATION_EFFECTIVE_DT  BETWEEN '1970-01-01' AND '2020-01-01' EACH INTERVAL '1' MONTH ,
 NO RANGE OR UNKNOWN) );

 
REPLACE VIEW LOCATION_PLL_V AS SELECT * FROM LOCATION_PLL; 


CREATE MULTISET TABLE ITEM_LDI ,FALLBACK ,
NO BEFORE JOURNAL,
NO AFTER JOURNAL,
CHECKSUM = DEFAULT,
DEFAULT MERGEBLOCKRATIO,
WITH CONCURRENT ISOLATED LOADING FOR ALL
     (
      ITEM_ID VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'ITEM_ID' NOT NULL,
      ITEM_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC TITLE 'ITEM_NAME' COMPRESS '',
      ITEM_LEVEL BYTEINT FORMAT '-ZZ9' CHECK ( NOT ((ITEM_LEVEL >=  -9 ) AND  (ITEM_LEVEL <=  9 )) ) NOT NULL,
      ITEM_DESC VARCHAR(250) CHARACTER SET UNICODE NOT CASESPECIFIC TITLE 'ITEM_DESC',
      ITEM_SUBCLASS_CD VARCHAR(50) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'ITEM_SUBCLASS_CD',
      ITEM_TYPE_CD VARCHAR(50) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'ITEM_TYPE_CD',
      INVENTORY_IND CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'INVENTORY_IND',
      VENDOR_PARTY_ID SMALLINT FORMAT '999' TITLE 'VENDOR_PARTY_ID',
      COMMODITY_CD VARCHAR(50) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'COMMODITY_CD',
      BRAND_CD VARCHAR(50) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'BRAND_CD',
      ITEM_AVAILABLE CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS (' ','N','Y'),
      PRODUCT_IMEI BYTE(6) TITLE 'PRODUCT_IMEI',
      ITEM_JSON JSON(4600) CHARACTER SET LATIN FORMAT 'X(20)' TITLE 'ITEM_JSON',
      ITEM_XML XML(2097088000) INLINE LENGTH 4046, 
CONSTRAINT ITE_SDRI_1 FOREIGN KEY ( BRAND_CD ) REFERENCES WITH NO CHECK OPTION BRAND ( BRAND_CD ))
PRIMARY INDEX ITM_UPI ( ITEM_ID )
PARTITION BY RANGE_N(ITEM_LEVEL  BETWEEN 0  AND 127  EACH 1 ,
NO RANGE OR UNKNOWN)
INDEX ITE_HOSI_3 ( BRAND_CD ) ORDER BY HASH ( BRAND_CD )
INDEX ITE_HOSI_4 ( ITEM_TYPE_CD ) ORDER BY HASH ( ITEM_TYPE_CD )
INDEX ITE_VOSI_1 ( VENDOR_PARTY_ID ) ORDER BY VALUES ( VENDOR_PARTY_ID )
UNIQUE INDEX ITE_USI_1 ( ITEM_ID );
 
 
REPLACE VIEW ITEM_LDI_V AS
LOCKING ITEM_LDI FOR LOAD COMMITTED SELECT * FROM ITEM_LDI;



CREATE MULTISET TABLE RETURN_TRANSACTION_LINE_LDI ,FALLBACK ,
NO BEFORE JOURNAL,
NO AFTER JOURNAL,
CHECKSUM = DEFAULT,
DEFAULT MERGEBLOCKRATIO,
WITH CONCURRENT ISOLATED LOADING FOR ALL
     (
      SALES_TRAN_ID BIGINT TITLE 'SALES_TRAN_ID' NOT NULL,
      RETURN_TRAN_LINE_NUM VARCHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'RETURN_TRAN_LINE_NUM' NOT NULL,
      RETURNED_ITEM_ID VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'ITEM_ID' NOT NULL,
      RETURN_ITEM_QTY DECIMAL(18,4) TITLE 'RETURN_ITEM_QTY' NOT NULL,
      UNIT_REFUND_AMT DECIMAL(18,4) TITLE 'UNIT_REFUND_AMT' NOT NULL,
      ORIGINAL_SALES_TRAN_LINE_NUM VARCHAR(4) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'ORIGINAL_SALES_TRAN_LINE_NUM',
      RETURN_TRAN_LINE_START_DTTM TIMESTAMP(6) TITLE 'RETURN_TRAN_LINE_START_DTTM' NOT NULL COMPRESS USING TD_SYSFNLIB.TS_COMPRESS DECOMPRESS USING TD_SYSFNLIB.TS_DECOMPRESS ,
      RETURN_TRAN_LINE_END_DTTM TIMESTAMP(6) TITLE 'RETURN_TRAN_LINE_END_DTTM' COMPRESS USING TD_SYSFNLIB.TS_COMPRESS DECOMPRESS USING TD_SYSFNLIB.TS_DECOMPRESS ,
      TRAN_LINE_STATUS_CD CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'TRAN_LINE_STATUS_CD',
      RETURN_REASON_CD VARCHAR(50) CHARACTER SET LATIN NOT CASESPECIFIC FORMAT 'X(1)' TITLE 'RETURN_REASON_CD',
      LOCATION_ID INTEGER TITLE 'LOCATION_ID',
      RETURN_ITEM_DURATION_1 INTERVAL DAY(4) TO MINUTE,
      RETURN_ITEM_DURATION_2 INTERVAL DAY(4) TO HOUR,
      RETURN_ITEM_DURATION_3 INTERVAL DAY(4) TO SECOND(6),
      ORIGINAL_SALES_TRAN_ID BIGINT TITLE 'ORIGINAL_SALES_TRAN_ID' NOT NULL, 
CONSTRAINT RTL_SDRI_1 FOREIGN KEY ( RETURN_REASON_CD ) REFERENCES WITH NO CHECK OPTION RETURN_REASON_LDI ( RETURN_REASON_CD ),
CONSTRAINT RTL_BTRI_1 FOREIGN KEY ( RETURNED_ITEM_ID ) REFERENCES WITH NO CHECK OPTION ITEM_LDI ( ITEM_ID ),
CONSTRAINT RTL_BTRI_2 FOREIGN KEY ( LOCATION_ID ) REFERENCES WITH NO CHECK OPTION LOCATION_PLL ( LOCATION_ID ))
PRIMARY INDEX RTL_NUPI ( SALES_TRAN_ID )
PARTITION BY ( RANGE_N(LOCATION_ID  BETWEEN 0  AND 2000000  EACH 100 ,
 NO RANGE OR UNKNOWN),CASE_N(
TRAN_LINE_STATUS_CD BETWEEN 'A'AND 'C',
TRAN_LINE_STATUS_CD BETWEEN 'D'AND 'K',
TRAN_LINE_STATUS_CD BETWEEN 'L'AND 'P',
TRAN_LINE_STATUS_CD BETWEEN 'Q'AND 'Z',
 NO CASE, UNKNOWN) )
INDEX RTL_HOSI_1 ( SALES_TRAN_ID ,RETURN_ITEM_QTY ) ORDER BY HASH ( SALES_TRAN_ID );

 
REPLACE VIEW RETURN_TRANSACTION_LINE_LDI_V AS
LOCKING RETURN_TRANSACTION_LINE_LDI FOR LOAD COMMITTED SELECT * FROM RETURN_TRANSACTION_LINE_LDI;
 
 
CREATE MULTISET TABLE ITEM_INVENTORY_LDI ,FALLBACK ,
NO BEFORE JOURNAL,
NO AFTER JOURNAL,
CHECKSUM = DEFAULT,
DEFAULT MERGEBLOCKRATIO,
WITH CONCURRENT ISOLATED LOADING FOR ALL
     (
      ITEM_INV_DT DATE FORMAT 'YYYY-MM-DD' TITLE 'ITEM_INV_DT' NOT NULL,
      ITEM_ID VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'ITEM_ID' NOT NULL,
      ON_HAND_UNIT_QTY DECIMAL(9,4) FORMAT '----------.9999' TITLE 'ON_HAND_UNIT_QTY' NOT NULL,
      ON_HAND_AT_RETAIL_AMT DECIMAL(18,4) TITLE 'ON_HAND_AT_RETAIL_AMT' NOT NULL,
      ON_HAND_COST_AMT DECIMAL(18,4) TITLE 'ON_HAND_COST_AMT' NOT NULL,
      ON_ORDER_QTY DECIMAL(18,4) TITLE 'ON_ORDER_QTY',
      LOST_SALES_DAY_IND CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'LOST_SALES_DAY_IND',
      ITEM_INV_EMPTY_TIME INTERVAL MINUTE(4) TO SECOND(6),
      ITEM_SERVICE_DURATION PERIOD(TIME(6) WITH TIME ZONE),
      ITEM_SERVICE_DURATION_2 PERIOD(TIME(6)) DEFAULT NULL ,
      LOCATION_ID INTEGER TITLE 'LOCATION_ID' NOT NULL, 
CONSTRAINT ITM_INVRI_1 FOREIGN KEY ( LOCATION_ID ) REFERENCES WITH NO CHECK OPTION LOCATION_PLL ( LOCATION_ID ),
CONSTRAINT ITM_INV_SDRI_1 FOREIGN KEY ( ITEM_ID ) REFERENCES WITH NO CHECK OPTION ITEM_LDI ( ITEM_ID ))
PRIMARY INDEX ( LOCATION_ID ,ITEM_ID )
INDEX ITI_HOSI_1 ( ITEM_ID ) ORDER BY HASH ( ITEM_ID )
INDEX ITI_VOSI_1 ( LOCATION_ID ,ON_HAND_UNIT_QTY ) ORDER BY VALUES ( LOCATION_ID );


REPLACE VIEW ITEM_INVENTORY_LDI_V AS
LOCKING ITEM_INVENTORY_LDI FOR LOAD COMMITTED SELECT * FROM ITEM_INVENTORY_LDI;
 
 
CREATE MULTISET TABLE ITEM_INVENTORY_PLAN_LDI ,FALLBACK ,
NO BEFORE JOURNAL,
NO AFTER JOURNAL,
CHECKSUM = DEFAULT,
DEFAULT MERGEBLOCKRATIO,
WITH CONCURRENT ISOLATED LOADING FOR ALL
     (
      ITEM_INVENTORY_PLAN_DT DATE FORMAT 'YYYY-MM-DD' TITLE 'ITEM_INVENTORY_PLAN_DT' NOT NULL,
      LOCATION_ID INTEGER TITLE 'LOCATION_ID' NOT NULL,
      ITEM_ID VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'ITEM_ID' NOT NULL,
      PLAN_ON_HAND_QTY DECIMAL(18,4) TITLE 'PLAN_ON_HAND_QTY',
      PLAN_ON_HAND_RETAIL_AMT DECIMAL(18,4) TITLE 'PLAN_ON_HAND_RETAIL_AMT', 
CONSTRAINT IIP_BTRI_1 FOREIGN KEY ( LOCATION_ID ) REFERENCES WITH NO CHECK OPTION LOCATION_PLL ( LOCATION_ID ),
CONSTRAINT IIP_BTRI_2 FOREIGN KEY ( ITEM_ID ) REFERENCES WITH NO CHECK OPTION ITEM_LDI ( ITEM_ID ))
PRIMARY INDEX IIP_UPI ( ITEM_INVENTORY_PLAN_DT ,LOCATION_ID ,
ITEM_ID )
PARTITION BY ( RANGE_N(LOCATION_ID  BETWEEN 0  AND 2000000  EACH 100 ,
 NO RANGE OR UNKNOWN),RANGE_N(ITEM_INVENTORY_PLAN_DT  BETWEEN '1970-01-01' AND '2010-01-01' EACH INTERVAL '1' MONTH ,
 NO RANGE OR UNKNOWN) );
 
REPLACE VIEW ITEM_INVENTORY_PLAN_LDI_V AS
LOCKING ITEM_INVENTORY_PLAN_LDI FOR LOAD COMMITTED SELECT * FROM ITEM_INVENTORY_PLAN_LDI;
 

CREATE MULTISET TABLE PARTY_PLL ,FALLBACK ,
NO BEFORE JOURNAL,
NO AFTER JOURNAL,
CHECKSUM = DEFAULT,
DEFAULT MERGEBLOCKRATIO
     (
      PARTY_ID VARCHAR(10) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'PARTY_ID' NOT NULL,
      PARTY_TYPE_CD CHAR(4) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'PARTY_TYPE_CD' NOT NULL,
      PARTY_FIRSTNAME VARCHAR(20) CHARACTER SET UNICODE NOT CASESPECIFIC TITLE 'PARTY_FIRSTNAME',
      PARTY_LASTNAME VARCHAR(20) CHARACTER SET UNICODE NOT CASESPECIFIC TITLE 'PARTY_LASTNAME' COMPRESS USING TD_SYSFNLIB.CAMSET DECOMPRESS USING TD_SYSFNLIB.DECAMSET ,
      PARTY_STREET_ADDRESS VARCHAR(50) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'PARTY_STREET_ADDRESS' COMPRESS USING TD_SYSFNLIB.LZCOMP_L DECOMPRESS USING TD_SYSFNLIB.LZDECOMP_L ,
      PARTY_CITY CHAR(30) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'PARTY_CITY',
      PARTY_STATE CHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'PARTY_STATE',
      PARTY_ZIP CHAR(5) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'PARTY_ZIP',
      PARTY_INFO_SOURCE_TYPE_CD CHAR(4) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'PARTY_INFO_SOURCE_TYPE_CD' COMPRESS USING TD_SYSFNLIB.CAMSET_L DECOMPRESS USING TD_SYSFNLIB.DECAMSET_L ,
      PARTY_START_DT DATE FORMAT 'YYYY-MM-DD' TITLE 'PARTY_START_DT',
      PARTY_FIRST_PURCHASE_DT DATE FORMAT 'YYYY-MM-DD' TITLE 'PARTY_FIRST_PURCHASE_DT',
      LOCATION_POINT SYSUDTLIB.ST_GEOMETRY(16776192) INLINE LENGTH 9920 TITLE 'LOCATION_POINT',
      ACTIVE_AREA SYSUDTLIB.ST_GEOMETRY(16776192) INLINE LENGTH 9920 TITLE 'ACTIVE_AREA',
      ACTIVE_LINES SYSUDTLIB.ST_GEOMETRY(16776192) INLINE LENGTH 9920 TITLE 'ACTIVE_LINES',
      KEY_LINE SYSUDTLIB.ST_GEOMETRY(16776192) INLINE LENGTH 9920 TITLE 'KEY_LINE',
      KEY_POINTS SYSUDTLIB.ST_GEOMETRY(16776192) INLINE LENGTH 9920 TITLE 'KEY_POINTS',
      ALL_RELATED_GEO SYSUDTLIB.ST_GEOMETRY(16776192) INLINE LENGTH 9920 TITLE 'ALL_RELATED_GEO')
PRIMARY INDEX PAR_UPI ( PARTY_ID )
PARTITION BY ( RANGE_N(PARTY_STATE  BETWEEN 'A' AND 'B',
'C' AND 'K',
'L' AND 'M',
'N' AND 'ZZ',
 NO RANGE OR UNKNOWN));
 
REPLACE VIEW PARTY_PLL_V AS
LOCKING PARTY_PLL FOR ACCESS SELECT * FROM PARTY_PLL;

 
CREATE MULTISET TABLE SALES_TRANSACTION_PLL ,FALLBACK ,
     NO BEFORE JOURNAL,
     NO AFTER JOURNAL,
     CHECKSUM = DEFAULT,
     DEFAULT MERGEBLOCKRATIO
     (
      SALES_TRAN_ID BIGINT TITLE 'SALES_TRAN_ID' NOT NULL,
      VISIT_ID INTEGER TITLE 'VISIT_ID',
      TRAN_STATUS_CD CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'TRAN_STATUS_CD',
      REPORTED_AS_DTTM TIMESTAMP(6) WITH TIME ZONE TITLE 'REPORTED_AS_DTTM',
      TRAN_TYPE_CD CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'TRAN_TYPE_CD',
      MKB_COST_AMT DECIMAL(18,4) TITLE 'MKB_COST_AMT',
      MKB_ITEM_QTY DECIMAL(18,4) TITLE 'MKB_ITEM_QTY' NOT NULL,
      MKB_NUMBER_UNIQUE_ITEMS_QTY DECIMAL(18,4) TITLE 'MKB_NUMBER_UNIQUE_ITEMS_QTY',
      MKB_REV_AMT DECIMAL(18,4) TITLE 'MKB_REV_AMT',
      ASSOCIATE_PARTY_ID INTEGER TITLE 'ASSOCIATE_PARTY_ID',
      TRAN_START_DTTM_DD TIMESTAMP(6) WITH TIME ZONE TITLE 'TRAN_START_DTTM_DD',
      TRAN_DATE DATE FORMAT 'YYYY-MM-DD' TITLE 'TRAN_DATE',
      TRAN_END_DTTM_DD TIMESTAMP(6) TITLE 'TRAN_END_DTTM_DD',
      TRAN_END_HOUR INTEGER TITLE 'TRAN_END_HOUR',
      TRAN_END_MINUTE INTEGER TITLE 'TRAN_END_MINUTE',
      REWARD_CD VARCHAR(10) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'REWARD_CD',
      TRANS_YEAR INTERVAL YEAR(4),
      TRAN_START_TM TIME(6) TITLE 'TRAN_START_TM' COMPRESS USING TD_SYSFNLIB.TS_COMPRESS DECOMPRESS USING TD_SYSFNLIB.TS_DECOMPRESS ,
      TRAN_END_TM TIME(6) WITH TIME ZONE TITLE 'TRAN_END_TM' COMPRESS USING TD_SYSFNLIB.TS_COMPRESS DECOMPRESS USING TD_SYSFNLIB.TS_DECOMPRESS ,
      SALES_TRANSACTION_JSON JSON(2800) CHARACTER SET UNICODE COMPRESS USING TD_SYSFNLIB.TD_LZ_COMPRESS DECOMPRESS USING TD_SYSFNLIB.TD_LZ_DECOMPRESS ,
      SALES_TRANSACTION_XML XML(2097088000) INLINE LENGTH 4046,
      PARTY_ID VARCHAR(10) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'PARTY_ID',
CONSTRAINT SP_RI_1 FOREIGN KEY ( PARTY_ID ) REFERENCES WITH NO CHECK OPTION PARTY_PLL ( PARTY_ID ))
NO PRIMARY INDEX
PARTITION BY ( COLUMN,RANGE_N(TRAN_DATE  BETWEEN '1970-01-01' AND '2022-01-01' EACH INTERVAL '1' MONTH ,
 NO RANGE, UNKNOWN));
 

REPLACE VIEW SALES_TRANSACTION_PLL_V AS 
LOCKING SALES_TRANSACTION_PLL FOR ACCESS SELECT * FROM SALES_TRANSACTION_PLL;
 
CREATE MULTISET TABLE SALES_TRANSACTION_LINE_PLL ,FALLBACK ,
     NO BEFORE JOURNAL,
     NO AFTER JOURNAL,
     CHECKSUM = DEFAULT,
     DEFAULT MERGEBLOCKRATIO
     (
      SALES_TRAN_ID BIGINT TITLE 'SALES_TRAN_ID' NOT NULL,
      SALES_TRAN_LINE_NUM SMALLINT TITLE 'SALES_TRAN_LINE_NUM' NOT NULL,
      ITEM_ID VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'ITEM_ID',
      ITEM_QTY NUMBER(5,0) FORMAT '-----9.' TITLE 'ITEM_QTY' NOT NULL,
      UNIT_SELLING_PRICE_AMT DECIMAL(8,4) TITLE 'UNIT_SELLING_PRICE_AMT' NOT NULL,
      UNIT_COST_AMT DECIMAL(8,4) TITLE 'UNIT_COST_AMT',
      TRAN_LINE_STATUS_CD CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'TRAN_LINE_STATUS_CD',
      SALES_TRAN_LINE_START_DTTM TIMESTAMP(6) TITLE 'SALES_TRAN_LINE_START_DTTM',
      TRAN_LINE_SALES_TYPE_CD CHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'TRAN_LINE_SALES_TYPE_CD',
      SALES_TRAN_LINE_END_DTTM TIMESTAMP(6) TITLE 'SALES_TRAN_LINE_END_DTTM',
      TRAN_LINE_DATE DATE FORMAT 'YYYY-MM-DD' TITLE 'TRAN_LINE_DATE',
      TX_TIME INTEGER TITLE 'TX_TIME' NOT NULL,
      LOCATION INTEGER TITLE 'LOCATION',
      LINE_RUN_DURATION_SECONDS INTERVAL SECOND(4,6),
      LINE_RUN_DURATION_MINUTES INTERVAL MINUTE(4) DEFAULT INTERVAL '0' MINUTE  COMPRESS ,
      LINE_RUN_DURATION_HOURS INTERVAL HOUR(4) DEFAULT INTERVAL '0' HOUR ,
      LINE_RUN_DURATION_DAYS INTERVAL DAY(4) DEFAULT NULL ,
      BENEFIT_RATE FLOAT TITLE 'BENEFIT_RATE',
CONSTRAINT STL_BTRI_1 FOREIGN KEY ( ITEM_ID ) REFERENCES WITH NO CHECK OPTION ITEM_LDI ( ITEM_ID ),
CONSTRAINT STL_BTRI_2 FOREIGN KEY ( LOCATION ) REFERENCES WITH NO CHECK OPTION LOCATION_PLL ( LOCATION_ID ))
NO PRIMARY INDEX
PARTITION BY ( COLUMN ADD 10,RANGE_N(LOCATION  BETWEEN 0  AND 2000000  EACH 100 , NO RANGE OR UNKNOWN));
 
REPLACE VIEW SALES_TRANSACTION_LINE_PLL_V AS
LOCKING SALES_TRANSACTION_LINE_PLL FOR ACCESS SELECT * FROM SALES_TRANSACTION_LINE_PLL;
 
 
CREATE MULTISET TABLE ITEM_PRICE_HISTORY ,FALLBACK ,
NO BEFORE JOURNAL,
NO AFTER JOURNAL,
CHECKSUM = DEFAULT,
DEFAULT MERGEBLOCKRATIO
     (
      ITEM_ID VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC FORMAT 'X(11)' TITLE 'ITEM_ID' NOT NULL,
      ITEM_PRICE_START_DT DATE FORMAT 'YYYY-MM-DD' TITLE 'ITEM_PRICE_START_DT' NOT NULL,
      PRICE_CHANGE_REASON_CD VARCHAR(50) CHARACTER SET LATIN NOT CASESPECIFIC FORMAT 'X(3)' TITLE 'PRICE_CHANGE_REASON_CD',
      ITEM_PRICE_AMT NUMBER(18,2) FORMAT '-----------------.99' TITLE 'ITEM_PRICE_AMT',
      CURRENT_INDICATOR CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'CURRENT_INDICATOR',
      LOCATION_ID INTEGER TITLE 'LOCATION_ID', 
CONSTRAINT IPH_SDRI_1 FOREIGN KEY ( PRICE_CHANGE_REASON_CD ) REFERENCES WITH NO CHECK OPTION PRICE_CHANGE_REASON ( PRICE_CHANGE_REASON_CD ),
CONSTRAINT IPH_BTRI_1 FOREIGN KEY ( ITEM_ID ) REFERENCES WITH NO CHECK OPTION ITEM_LDI ( ITEM_ID ))
PRIMARY INDEX IPH_NUPI ( ITEM_ID )
PARTITION BY RANGE_N(ITEM_PRICE_START_DT  BETWEEN '1970-01-01' AND '2012-01-01' EACH INTERVAL '1' MONTH ,
 NO RANGE, UNKNOWN)
INDEX IPH_HOSI_1 ( ITEM_ID ) ORDER BY HASH ( ITEM_ID );
 
REPLACE VIEW ITEM_PRICE_HISTORY_V AS SELECT * FROM ITEM_PRICE_HISTORY;
 
CREATE SET TABLE ITEM_STORE_SOLD ,FALLBACK ,
NO BEFORE JOURNAL,
NO AFTER JOURNAL,
CHECKSUM = DEFAULT,
DEFAULT MERGEBLOCKRATIO
     (
      PRODUCT_ID DECIMAL(15,0) TITLE 'PRODUCT_ID',
      WEEK_OF_YEAR BYTEINT TITLE 'WEEK_OF_YEAR' CHECK ( (WEEK_OF_YEAR >=  1 ) AND  (WEEK_OF_YEAR <=  53 ) ) NOT NULL,
      ON_HAND_QTY BIGINT TITLE 'ON_HAND_QTY',
      HAND_RETAIL_AMT DECIMAL(18,2) TITLE 'HAND_RETAIL_AMT',
      PLAN_QTY BIGINT TITLE 'PLAN_QTY',
      PLAN_RETAIL_AMT DECIMAL(18,2) TITLE 'PLAN_RETAIL_AMT',
      QTY_SOLD BIGINT TITLE 'QTY_SOLD',
      REVENUE NUMBER(18,2) FORMAT '-----------------.99' TITLE 'REVENUE',
      LOCATION_ID INTEGER TITLE 'LOCATION_ID',
      PRODUCT_IMEI BYTE(12), 
CONSTRAINT ISS_SDRI_1 FOREIGN KEY ( LOCATION_ID ) REFERENCES WITH NO CHECK OPTION LOCATION_PLL ( LOCATION_ID ))
PRIMARY INDEX ISS_NUPI ( PRODUCT_ID ,WEEK_OF_YEAR ,LOCATION_ID )
PARTITION BY ( RANGE_N(WEEK_OF_YEAR  BETWEEN 1  AND 53  EACH 1 ,
 NO RANGE OR UNKNOWN),RANGE_N(LOCATION_ID  BETWEEN 0  AND 2000000  EACH 100 ,
 NO RANGE OR UNKNOWN) );
 
REPLACE VIEW ITEM_STORE_SOLD_V AS SELECT * FROM ITEM_STORE_SOLD;
 

CREATE MULTISET TABLE BRAND_OWNER_ORG ,NO FALLBACK ,
     NO BEFORE JOURNAL,
     NO AFTER JOURNAL,
     CHECKSUM = DEFAULT,
     DEFAULT MERGEBLOCKRATIO
     (
      BRAND_PARTY_ID INTEGER FORMAT '-(3)9' TITLE 'BRAND_PARTY_ID' CHECK ( NOT (BRAND_PARTY_ID <  0 ) ) NOT NULL)
PRIMARY INDEX BOO_NUPI ( BRAND_PARTY_ID );

REPLACE VIEW BRAND_OWNER_ORG_V AS  SELECT * FROM BRAND_OWNER_ORG;

 
CREATE SET TABLE BRAND ,FALLBACK ,
NO BEFORE JOURNAL,
NO AFTER JOURNAL,
CHECKSUM = DEFAULT,
DEFAULT MERGEBLOCKRATIO
     (
      MFG VARCHAR(50) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'MFG' NOT NULL,
      BRAND_CD VARCHAR(50) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'BRAND_CD' NOT NULL,
      BRAND_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC TITLE 'BRAND_NAME' NOT NULL,
      BRAND_PARTY_ID INTEGER FORMAT '-(3)9' TITLE 'BRAND_PARTY_ID',
      BRAND_LEVEL SMALLINT FORMAT '9(5)' CHECK ( (BRAND_LEVEL >=  1000 ) AND  (BRAND_LEVEL <=  32001 ) ), 
CONSTRAINT BOO_SDRI_1 FOREIGN KEY ( BRAND_PARTY_ID ) REFERENCES WITH NO CHECK OPTION BRAND_OWNER_ORG ( BRAND_PARTY_ID ))
UNIQUE PRIMARY INDEX BRA_UPI ( BRAND_CD );
 
REPLACE VIEW BRAND_V AS  SELECT * FROM BRAND;
 

 
CREATE MULTISET TABLE DISTRICT ,FALLBACK ,
NO BEFORE JOURNAL,
NO AFTER JOURNAL,
CHECKSUM = DEFAULT,
DEFAULT MERGEBLOCKRATIO
     (
      DISTRICT_CD VARCHAR(50) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'DISTRICT_CD' NOT NULL,
      DISTRICT_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC TITLE 'DISTRICT_NAME',
      REGION_CD VARCHAR(50) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'REGION_CD' NOT NULL,
      DISTRICT_MGR_ASSOCIATE_ID INTEGER TITLE 'DISTRICT_MGR_ASSOCIATE_ID',
      DISTRICT_JSON JSON(5900) CHARACTER SET UNICODE FORMAT 'X(100)' TITLE 'DISTRICT_JSON' COMPRESS USING TD_SYSFNLIB.JSON_COMPRESS DECOMPRESS USING TD_SYSFNLIB.JSON_DECOMPRESS ,
      DISTRICT_XML XML(2097088000) INLINE LENGTH 4046, 
CONSTRAINT DIS_SDRI_1 FOREIGN KEY ( REGION_CD ) REFERENCES WITH NO CHECK OPTION REGION ( REGION_CD ))
UNIQUE PRIMARY INDEX DIS_UPI ( DISTRICT_CD );
 
REPLACE VIEW DISTRICT_V AS  SELECT * FROM DISTRICT;
 
CREATE MULTISET TABLE LOCATION_TYPE ,FALLBACK ,
NO BEFORE JOURNAL,
NO AFTER JOURNAL,
CHECKSUM = DEFAULT,
DEFAULT MERGEBLOCKRATIO
     (
      LOCATION_TYPE_CD VARCHAR(10) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'LOCATION_TYPE_CD' NOT NULL,
      LOCATION_TYPE_DESC VARCHAR(10) CHARACTER SET UNICODE NOT CASESPECIFIC TITLE 'LOCATION_TYPE_DESC' NOT NULL,
      LOCATION_COST DECIMAL(8,2) FORMAT 'ZZZ,ZZ9.99' CHECK ( (LOCATION_COST >=  0.00 ) AND  (LOCATION_COST <=  999000.00 ) ))
PRIMARY AMP INDEX ( LOCATION_TYPE_CD )
PARTITION BY COLUMN ADD 65529;
 
REPLACE VIEW LOCATION_TYPE_V AS  SELECT * FROM LOCATION_TYPE;
 
CREATE MULTISET TABLE CHANNEL ,FALLBACK ,
NO BEFORE JOURNAL,
NO AFTER JOURNAL,
CHECKSUM = DEFAULT,
DEFAULT MERGEBLOCKRATIO
     (
      CHANNEL_CD VARCHAR(50) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'CHANNEL_CD' NOT NULL,
      CHANNEL_DESC VARCHAR(250) CHARACTER SET UNICODE NOT CASESPECIFIC TITLE 'CHANNEL_DESC')
UNIQUE PRIMARY INDEX CHA_UPI ( CHANNEL_CD );
 
REPLACE VIEW CHANNEL_V AS  SELECT * FROM CHANNEL;
 
CREATE MULTISET TABLE LOCATION_PLAN ,FALLBACK ,
NO BEFORE JOURNAL,
NO AFTER JOURNAL,
CHECKSUM = DEFAULT,
DEFAULT MERGEBLOCKRATIO
     (
      LOCATION_ID INTEGER TITLE 'LOCATION_ID' NOT NULL,
      COST_CD VARCHAR(50) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'COST_CD' NOT NULL,
      PERIOD_START_DT DATE FORMAT 'YYYY-MM-DD' TITLE 'PERIOD_START_DT' NOT NULL,
      PERIOD_END_DT DATE FORMAT 'YYYY-MM-DD' TITLE 'PERIOD_END_DT',
      ACTUAL_COST_AMT DECIMAL(18,4) TITLE 'ACTUAL_COST_AMT',
      PLAN_COST_AMT DECIMAL(18,4) TITLE 'PLAN_COST_AMT' NOT NULL,
      COST_JSON JSON(16776192) INLINE LENGTH 4096 CHARACTER SET LATIN FORMAT 'X(500)' TITLE 'COST_JSON',
      COST_XML XML(2097088000) INLINE LENGTH 4046, 
CONSTRAINT COS_SDRI_1 FOREIGN KEY ( COST_CD ) REFERENCES WITH NO CHECK OPTION COST ( COST_CD ),
CONSTRAINT LOP_BTRI_1 FOREIGN KEY ( LOCATION_ID ) REFERENCES WITH NO CHECK OPTION LOCATION_PLL ( LOCATION_ID ))
PRIMARY INDEX LOP_UPI ( LOCATION_ID ,COST_CD ,PERIOD_START_DT )
PARTITION BY ( RANGE_N(PERIOD_START_DT  BETWEEN '1970-01-01' AND '2012-01-01' EACH INTERVAL '1' MONTH ,
 NO RANGE OR UNKNOWN),RANGE_N(LOCATION_ID  BETWEEN 0  AND 2000000  EACH 100 ,
 NO RANGE OR UNKNOWN) );
 
REPLACE VIEW LOCATION_PLAN_V AS  SELECT * FROM LOCATION_PLAN;


CREATE SET TABLE REGION ,NO FALLBACK ,
     NO BEFORE JOURNAL,
     NO AFTER JOURNAL,
     CHECKSUM = DEFAULT,
     DEFAULT MERGEBLOCKRATIO
     (
      REGION_CD VARCHAR(50) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'REGION_CD' NOT NULL,
      REGION_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC TITLE 'REGION_NAME' NOT NULL,
      DIVISION_CD VARCHAR(10) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'DIVISION_CD' NOT NULL,
      REGION_MGR_ASSOCIATE_ID INTEGER TITLE 'REGION_MGR_ASSOCIATE_ID', 
CONSTRAINT REG_SDRI_1 FOREIGN KEY ( DIVISION_CD ) REFERENCES WITH NO CHECK OPTION DIVISION ( DIVISION_CD ))
UNIQUE PRIMARY INDEX REG_UPI ( REGION_CD );

REPLACE VIEW REGION_V AS  SELECT * FROM REGION;

CREATE MULTISET TABLE DIVISION ,NO FALLBACK ,
     NO BEFORE JOURNAL,
     NO AFTER JOURNAL,
     CHECKSUM = DEFAULT,
     DEFAULT MERGEBLOCKRATIO
     (
      DIVISION_CD VARCHAR(10) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'DIVISION_CD' NOT NULL,
      DIVISION_NAME VARCHAR(10) CHARACTER SET UNICODE NOT CASESPECIFIC TITLE 'DIVISION_NAME' NOT NULL,
      ALL_DIVISIONS_CD VARCHAR(50) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'ALL_DIVISIONS_CD' NOT NULL,
      DIVISION_MGR_ASSOCIATE_ID INTEGER TITLE 'DIVISION_MGR_ASSOCIATE_ID',
      DIVISION_LEVEL BYTEINT FORMAT 'Z9' CHECK ( (DIVISION_LEVEL >=  0 ) AND  (DIVISION_LEVEL <=  2 ) ) COMPRESS (0 ,2 ))
UNIQUE PRIMARY INDEX DIV_UPI ( DIVISION_CD );

REPLACE VIEW DIVISION_V AS  SELECT * FROM DIVISION;


CREATE SET TABLE ALL_DIVISIONS ,NO FALLBACK ,
     NO BEFORE JOURNAL,
     NO AFTER JOURNAL,
     CHECKSUM = DEFAULT,
     DEFAULT MERGEBLOCKRATIO
     (
      ALL_DIVISIONS_CD VARCHAR(50) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'ALL_DIVISIONS_CD' NOT NULL,
      ALL_DIVISIONS_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC TITLE 'ALL_DIVISIONS_NAME',
      ALL_DIVISIONS_LEVEL BYTEINT FORMAT 'Z9' CHECK ( (ALL_DIVISIONS_LEVEL >=  0 ) AND  (ALL_DIVISIONS_LEVEL <=  12 ) ))
UNIQUE PRIMARY INDEX ALD_UPI ( ALL_DIVISIONS_CD );

REPLACE VIEW ALL_DIVISIONS_V AS  SELECT * FROM ALL_DIVISIONS;


CREATE SET TABLE PRICE_CHANGE_REASON ,NO FALLBACK ,
     NO BEFORE JOURNAL,
     NO AFTER JOURNAL,
     CHECKSUM = DEFAULT,
     DEFAULT MERGEBLOCKRATIO
     (
      PRICE_CHANGE_REASON_CD VARCHAR(50) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'PRICE_CHANGE_REASON_CD' NOT NULL,
      PRICE_CHANGE_REASON_DESC VARCHAR(250) CHARACTER SET UNICODE NOT CASESPECIFIC TITLE 'PRICE_CHANGE_REASON_DESC',
      PRICE_CHANGE_LEVEL BYTEINT FORMAT 'Z9' CHECK ( (PRICE_CHANGE_LEVEL >=  0 ) AND  (PRICE_CHANGE_LEVEL <=  2 ) ) COMPRESS (0 ,1 ,2 ))
UNIQUE PRIMARY INDEX PCR_UPI ( PRICE_CHANGE_REASON_CD );

REPLACE VIEW PRICE_CHANGE_REASON_V AS  SELECT * FROM PRICE_CHANGE_REASON;

CREATE MULTISET TABLE COST ,NO FALLBACK ,
     NO BEFORE JOURNAL,
     NO AFTER JOURNAL,
     CHECKSUM = DEFAULT,
     DEFAULT MERGEBLOCKRATIO
     (
      COST_CD VARCHAR(50) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'COST_CD' NOT NULL,
      COST_DESC BLOB(2097088000) TITLE 'COST_DESC',
      COST_GRADE SMALLINT FORMAT '999' CHECK ( (COST_GRADE >=  100 ) AND  (COST_GRADE <=  900 ) ) NOT NULL,
      COST_VALUE DECIMAL(8,2) FORMAT 'ZZZ,ZZ9.99' CHECK ( (COST_VALUE >=  1.00 ) AND  (COST_VALUE <=  999000.00 ) ),
      COST_TOTAL BIGINT CHECK ( COST_TOTAL <  2147483647  ) NOT NULL)
PRIMARY INDEX COS_UPI ( COST_CD )
PARTITION BY COLUMN ALL BUT (ROW(COST_DESC, COST_GRADE), COLUMN(COST_VALUE, COST_TOTAL)) ADD 65529;

REPLACE VIEW COST_V AS  SELECT * FROM COST;

 
CREATE JOIN INDEX USSJI_ITS ,NO FALLBACK ,CHECKSUM = DEFAULT AS 
SELECT COUNT(*)(FLOAT, NAMED CountStar ),ITEM_STORE_SOLD.LOCATION_ID (NAMED JIXC1 ),
SUM(ITEM_STORE_SOLD.PLAN_RETAIL_AMT - ITEM_STORE_SOLD.HAND_RETAIL_AMT )(DECIMAL(38,2), NAMED JIXC3 ),
SUM(ITEM_STORE_SOLD.PLAN_QTY - ITEM_STORE_SOLD.QTY_SOLD )(FLOAT, NAMED JIXC4 ),
SUM(ITEM_STORE_SOLD.ON_HAND_QTY )(FLOAT, NAMED JIXC5 ),
SUM(ITEM_STORE_SOLD.REVENUE )(FLOAT, NAMED JIXC6 )
 FROM ITEM_STORE_SOLD 
GROUP BY ITEM_STORE_SOLD.LOCATION_ID (NAMED JIXC1 )
PRIMARY INDEX USSJI_ITS_NUPI ( JIXC1 );